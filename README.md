# FSLR              <img src="https://www.abuse.nl/assets/logos/tudelft.png" width="100" height="50">  <img src="https://www.annabel.nu/wp-content/uploads/2023/03/Erasmus-MC-logo.png" width="100" height="50">

[![Python Version](https://img.shields.io/static/v1.svg?label=Python%20Version&message=3.9&color=blue)](https://www.python.org/downloads)

Implementation of retrieving the fragment short/long ratio's (FSLR) from the DELFI method by Cristiano et al. [1] implemented in Python.
Supports multiprocessing and the use of .yaml files to set program parameters.

## Installation
<!---
This section should contain installation, testing, and running instructions for people who want to get started with the project. 

- These instructions should work on a clean system.
- These instructions should work without having to install an IDE.
- You can specify that the user should have a certain operating system.
--->
Recommended installation uses a new Anaconda environment. 
<!---
To ease the process, this project includes an environment file.
This can be plugged into Anaconda [following this short tutorial](https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#creating-an-environment-from-an-environment-yml-file).
--->

Then to run the project, simply call the ```src/fslr.py``` from the root directory with the desired config file like so:
```bash
python src/fslr.py -c configs/delfi_fslr.yaml
```
- The experiment name is set in the config file, or in the command line using ```-e experiment_name```
- All results and model outputs will be stored in the project's ```results``` directory
- The results are stored as .bam file specific npy arrays of the FSLR ratio's
- All informational print statements are saved to a log.txt file, using a logger found in the util folder.
- The genomic bins of interest should be provided in a .bed file, and can be generated by ```genome_bins.py``` in ```src/util```.
- This project also used the default ENCODE blacklist file which should be stored in ```/beds```.

## File Structure
```
.
├── LICENSE
├── README.md
├── .gitignore
├── beds
│       └── hg38_100kb.bed
│       └── hg38_5mb.bed
├── configs
│       └── delfi_fslr.yaml
├── data/
├── results/
└── src
    ├── util/
    ├── fslr.py
```

## Authors
    - Bram Pronk                    I.B.Pronk@tudelft.nl

## Citations
- Cristiano, S., Leal, A., Phallen, J. et al. Genome-wide cell-free DNA fragmentation in patients with cancer. Nature 570, 385–389 (2019). https://doi.org/10.1038/s41586-019-1272-6
